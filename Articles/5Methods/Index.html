<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>5 Ways to Enable Sideloading for Metro Apps in Windows 8.x (zh-CN) by Winter</title>
<link rel="stylesheet" type="text/css" href="../../Libs/MetroUI/metro.css">
<link rel="stylesheet" type="text/css" href="../../Libs/Fonts/fonts.css">
<link rel="stylesheet" type="text/css" href="../../Libs/MetroUI/metrodark.css">
<style>
	body {
		margin: 24px;
		height: calc(100vh - 48px);
		display: flex;
		flex-direction: column;
		background-color: transparent;
		overflow: hidden;
	}

	#article-toturial {
		flex: 1;
		display: flex;
		flex-direction: column;
		gap: 20px;
		background-color: rgba(0,0,0,0.22);
	}

	#bili-video {
		flex: 3;
		min-height: 300px;
		position: relative;
	}

	#comment {
		flex: 1;
		min-height: 200px; 
		background: rgba(255,255,255,0.05);
		border-radius: 4px;
		overflow: hidden;
	}

	iframe {
		width: 100%;
		height: 100%;
		border: none;
		position: absolute;
	}

	#ie-video-container {
		display: none;
		width: 100%;
		height: 100%;
		background: #000;
	}

	/* IE专用样式（条件注释+媒体查询双保险） */
	<!--[if IE]>
	<style>
		#article-toturial {
			display: block !important;
			height: 100%;
		}
		#html5-player {
			display: none !important;
		}
		#ie-video-container {
			display: block !important;
			height: 70vh !important;
		}
		#comment {
			height: calc(30vh - 40px) !important; /* 增加底部留白 */
			margin-top: 20px;
		}
		#comment iframe {
			position: static !important;
		}
	</style>
	<![endif]-->
	@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
		#article-toturial {
			display: block !important;
			height: 100%;
		}
		#html5-player {
			display: none !important;
		}
		#ie-video-container {
			display: block !important;
			height: 70vh !important;
		}
		#comment {
			height: calc(30vh - 40px) !important;
			margin-top: 20px;
		}
		#comment iframe {
			position: static !important;
		}
	}
</style>
</head>

<body>
	<div id="article-toturial">
		<h1 style="margin-bottom: 20px">5 种为 Windows 8.x 开启 Metro 应用侧载的方法合集与比较</h1>
		<div id="bili-video">
			<iframe id="html5-player"
					src="//player.bilibili.com/player.html?isOutside=true&aid=114045222917255&bvid=BV1kkPAe1EA4&cid=28514911836&p=1" 
					scrolling="no" 
					frameborder="no" 
					allowfullscreen="true">
			</iframe>
			<div id="ie-video-container">
				<video id="ie-video-player" 
					   controls 
					   controlsList="nodownload" 
					   style="width:100%;height:100%;">
					<source src="bilivideo.mp4" type="video/mp4">
					<source src="bilivideo.webm" type="video/webm">
					您的浏览器不支持HTML5视频，请升级到现代浏览器
				</video>
			</div>
		</div>
		<div id="comment">
			<iframe src="//www.bilibili.com/h5/comment/sub?oid=233279383&pageType=1&root=255333250865"></iframe>
		</div>
	</div>

	<script>
	// 增强版IE检测（兼容IE5-11）
	function isInternetExplorer() {
		return /*@cc_on!@*/false || !!document.documentMode;
	}

	// 确保DOM加载完成
	function init() {
		if (isInternetExplorer()) {
			// 强制显示视频容器
			var ieVideoContainer = document.getElementById('ie-video-container');
			if (ieVideoContainer) {
				ieVideoContainer.style.display = 'block';
				ieVideoContainer.style.height = (window.innerHeight * 0.7) + 'px';
			}
			
			// 隐藏B站播放器
			var biliPlayer = document.getElementById('html5-player');
			if (biliPlayer) biliPlayer.style.display = 'none';

			// 设置评论区域高度
			var comment = document.getElementById('comment');
			if (comment) {
				var availHeight = window.innerHeight - document.querySelector('h1').offsetHeight - 100;
				comment.style.height = Math.max(200, availHeight * 0.3) + 'px';
			}

			// 视频高度适配
			var videoPlayer = document.getElementById('ie-video-player');
			if (videoPlayer) {
				videoPlayer.style.height = ieVideoContainer.offsetHeight + 'px';
			}
		}
	}

	// 响应式调整
	function handleResize() {
		if (isInternetExplorer()) {
			var ieVideoContainer = document.getElementById('ie-video-container');
			var comment = document.getElementById('comment');
			var videoPlayer = document.getElementById('ie-video-player');
			
			if (ieVideoContainer) {
				ieVideoContainer.style.height = (window.innerHeight * 0.7) + 'px';
			}
			if (videoPlayer && ieVideoContainer) {
				videoPlayer.style.height = ieVideoContainer.offsetHeight + 'px';
			}
			if (comment) {
				var availHeight = window.innerHeight - document.querySelector('h1').offsetHeight - 100;
				comment.style.height = Math.max(200, availHeight * 0.3) + 'px';
			}
		}
	}

	// 兼容旧版IE的事件绑定
	if (window.attachEvent) {
		window.attachEvent('onload', init);
		window.attachEvent('onresize', handleResize);
	} else {
		document.addEventListener('DOMContentLoaded', init);
		window.addEventListener('resize', handleResize);
	}
	</script>
</body>
</html>