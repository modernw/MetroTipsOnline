<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>5 Ways to Enable Sideloading for Metro Apps in Windows 8.x (zh-CN) by Winter</title>
<link rel="stylesheet" type="text/css" href="../../Libs/MetroUI/metro.css">
<link rel="stylesheet" type="text/css" href="../../Libs/Fonts/fonts.css">
<link rel="stylesheet" type="text/css" href="../../Libs/MetroUI/metrodark.css">
<style>
	body {
		margin: 24px;
		height: calc(120vh - 48px);
		display: flex;
		flex-direction: column;
		background-color: transparent;
	}
	#article-toturial {
		flex: 1;
		display: flex;
		flex-direction: column;
	}
	#bili-video {
		flex: 1;
		min-height: 0;
		position: relative;
	}
	iframe {
		width: 100%;
		height: 90%;
		border: none;
		position: absolute;
	}
	#ie-video-container {
		display: none;
		width: 100%;
		height: 90%;
		background: #000;
	}
	@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
		#bili-video {
			display: flex !important;
			flex-direction: column;
		}
	}
</style>
</head>

<body>
	<div id="article-toturial" style="background-color: rgba(0,0,0,0.22);">
		<h1>5 种为 Windows 8.x 开启 Metro 应用侧载的方法合集与比较 - Li_zip</h1>
		<soan>感谢大佬 <a class="navigation-text" href="https://space.bilibili.com/520126091" target="_blank">@Li_zip</a> 提供的方法。</soan>
		<span>用于 Windows 8.x 旁侧载的工具 链接：<a class="navigation-text" href="https://www.123684.com/s/Nu9rVv-eruch" target="_blank">https://www.123684.com/s/Nu9rVv-eruch</a></span>
		<span>Windows Store Service Crack 链接：<a class="navigation-text" href="https://github.com/AndnixSH/wsservice_crk" target="_blank">https://github.com/AndnixSH/wsservice_crk</a></span>
		<div id="bili-video">
			<iframe id="html5-player"
					src="//player.bilibili.com/player.html?isOutside=true&aid=114045222917255&bvid=BV1kkPAe1EA4&cid=28514911836&p=1" 
					scrolling="no" 
					frameborder="no" 
					allowfullscreen="true"
					style="position: absolute; left: 0; top: 0;">
			</iframe>
			<div id="ie-video-container">
				<video id="ie-video-player" 
					   controls 
					   controlsList="nodownload" 
					   style="width:100%;height:100%;font-family: 'Microsoft YaHei Light', 'Microsoft YaHei', 'Segoe UI'">
					<source src="bilivideo.mp4" type="video/mp4">
					您的浏览器不支持视频播放
				</video>
			</div>
		</div>
        <!-- <div id="comment">
            <iframe src="//www.bilibili.com/h5/comment/sub?oid=233279383&pageType=1&root=255333250865" width="100%"></iframe>
        </div> -->
	</div>

	<script>
	function isInternetExplorer() {
		return window.navigator.userAgent.match(/(MSIE|Trident)/i);
	}

	function initVideoPlayer() {
		if (isInternetExplorer()) {
			var iframePlayer = document.getElementById('html5-player');
			iframePlayer.style.display = 'none';
			iframePlayer.src = null;
			var ieContainer = document.getElementById('ie-video-container');
			ieContainer.style.display = 'block';
			var videoPlayer = document.getElementById('ie-video-player');
			try {
				videoPlayer.controls = true;
				videoPlayer.style.height = ieContainer.offsetHeight + 'px';
				videoPlayer.play().catch(function(error) {
					console.log('自动播放被阻止:', error);
				});
				videoPlayer.addEventListener('webkitbeginfullscreen', function() {
					this.controls = false;
				}, false);
				
			} catch (e) {
				console.error('IE视频播放器初始化失败:', e);
			}
		}
	}
	window.addEventListener('load', function() {
		initVideoPlayer();
		if (isInternetExplorer()) {
			window.addEventListener('resize', function() {
				var container = document.getElementById('bili-video');
				var videoPlayer = document.getElementById('ie-video-player');
				if (container && videoPlayer) {
					videoPlayer.style.height = container.offsetHeight + 'px';
				}
			});
		}
	});
	</script>
</body>
</html>
