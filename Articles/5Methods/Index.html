<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>5 Ways to Enable Sideloading for Metro Apps in Windows 8.x (zh-CN) by Winter</title>
<link rel="stylesheet" type="text/css" href="../../Libs/MetroUI/metro.css">
<link rel="stylesheet" type="text/css" href="../../Libs/Fonts/fonts.css">
<link rel="stylesheet" type="text/css" href="../../Libs/MetroUI/metrodark.css">
<style>
	body {
		margin: 24px;
		height: calc(100vh - 48px); /* 修正高度计算 */
		display: flex;
		flex-direction: column;
		background-color: transparent;
		overflow: hidden; /* 防止整体页面滚动 */
	}

	#article-toturial {
		flex: 1;
		display: flex;
		flex-direction: column;
		gap: 20px; /* 添加元素间距 */
	}

	#bili-video {
		flex: 3; /* 视频区域占比3份 */
		min-height: 300px; /* 最小高度保障 */
		position: relative;
	}

	#comment {
		flex: 1; /* 评论区域占比1份 */
		min-height: 200px; 
		background: rgba(255,255,255,0.05);
		border-radius: 4px;
		overflow: hidden;
	}

	iframe {
		width: 100%;
		height: 100%;
		border: none;
		position: absolute;
	}

	#ie-video-container {
		display: none;
		width: 100%;
		height: 100%;
		background: #000;
	}

	/* IE专用样式 */
	@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
		#article-toturial {
			display: block !important; /* 改用传统布局 */
		}

		#bili-video {
			height: 70vh; /* 视口高度百分比 */
			margin-bottom: 20px;
		}

		#comment {
			height: calc(30vh - 20px); /* 剩余高度减去间距 */
		}

		#comment iframe {
			position: relative !important;
			height: 100% !important;
		}
	}
</style>
</head>

<body>
	<div id="article-toturial" style="background-color: rgba(0,0,0,0.22);">
		<h1>5 种为 Windows 8.x 开启 Metro 应用侧载的方法合集与比较</h1>
		<div id="bili-video">
			<iframe id="html5-player"
					src="//player.bilibili.com/player.html?isOutside=true&aid=114045222917255&bvid=BV1kkPAe1EA4&cid=28514911836&p=1" 
					scrolling="no" 
					frameborder="no" 
					allowfullscreen="true"
					style="position: absolute; left: 0; top: 0;">
			</iframe>
			<div id="ie-video-container">
				<video id="ie-video-player" 
					   controls 
					   controlsList="nodownload" 
					   style="width:100%;height:100%;font-family: 'Microsoft YaHei Light', 'Microsoft YaHei', 'Segoe UI'">
					<source src="bilivideo.mp4" type="video/mp4">
					您的浏览器不支持视频播放
				</video>
			</div>
		</div>
		<div id="comment">
			<iframe src="//www.bilibili.com/h5/comment/sub?oid=233279383&pageType=1&root=255333250865" 
					style="width:100%; height:100%"></iframe>
		</div>
	</div>

	<script>
	// 新增评论区域高度控制
	function adjustCommentHeight() {
		var comment = document.getElementById('comment');
		if (comment) {
			// 现代浏览器自动处理
			if (!isInternetExplorer()) return;
			
			// IE专用高度计算
			var headerHeight = document.querySelector('h1').offsetHeight;
			var container = document.getElementById('article-toturial');
			comment.style.height = (container.offsetHeight - headerHeight - 20) * 0.3 + 'px';
		}
	}

	// 修改后的初始化函数
	function initVideoPlayer() {
		if (isInternetExplorer()) {
			// 原有视频处理代码...
			adjustCommentHeight();
		}
	}

	// 窗口大小变化处理
	window.addEventListener('resize', function() {
		if (isInternetExplorer()) {
			adjustCommentHeight();
			var videoPlayer = document.getElementById('ie-video-player');
			if (videoPlayer) {
				videoPlayer.style.height = document.getElementById('bili-video').offsetHeight + 'px';
			}
		}
	});
	</script>
</body>
</html>