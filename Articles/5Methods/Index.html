<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>5 Ways to Enable Sideloading for Metro Apps in Windows 8.x (zh-CN) by Winter</title>
<link rel="stylesheet" type="text/css" href="../../Libs/MetroUI/metro.css">
<link rel="stylesheet" type="text/css" href="../../Libs/Fonts/fonts.css">
<link rel="stylesheet" type="text/css" href="../../Libs/MetroUI/metrodark.css">
<style>
	body {
		margin: 24px;
		height: calc(100vh - 48px);
		display: flex;
		flex-direction: column;
		background-color: transparent;
		overflow: hidden;
	}

	#article-toturial {
		flex: 1;
		display: flex;
		flex-direction: column;
		gap: 20px;
		background-color: rgba(0,0,0,0.22);
	}

	#bili-video {
		flex: 3;
		min-height: 300px;
		position: relative;
	}

	#comment {
		flex: 1;
		min-height: 200px; 
		background: rgba(255,255,255,0.05);
		border-radius: 4px;
		overflow: hidden;
	}

	iframe {
		width: 100%;
		height: 100%;
		border: none;
		position: absolute;
	}

	/* 默认隐藏IE视频容器 */
	#ie-video-container {
		display: none;
		width: 100%;
		height: 100%;
		background: #000;
	}

	/* IE专用样式 */
	@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
		#article-toturial {
			display: block !important;
		}

		#html5-player {
			display: none !important;
		}

		#ie-video-container {
			display: block !important;
		}

		#bili-video {
			height: 70vh;
			margin-bottom: 20px;
		}

		#comment {
			height: calc(30vh - 20px);
		}

		#comment iframe {
			position: relative !important;
			height: 100% !important;
		}
	}
</style>
</head>

<body>
	<div id="article-toturial">
		<h1>5 种为 Windows 8.x 开启 Metro 应用侧载的方法合集与比较</h1>
		<div id="bili-video">
			<!-- 默认显示B站播放器 -->
			<iframe id="html5-player"
					src="//player.bilibili.com/player.html?isOutside=true&aid=114045222917255&bvid=BV1kkPAe1EA4&cid=28514911836&p=1" 
					scrolling="no" 
					frameborder="no" 
					allowfullscreen="true"
					style="position: absolute; left: 0; top: 0;">
			</iframe>
			
			<!-- IE专用视频容器 -->
			<div id="ie-video-container">
				<video id="ie-video-player" 
					   controls 
					   controlsList="nodownload" 
					   style="width:100%;height:100%;font-family: 'Microsoft YaHei Light', 'Microsoft YaHei', 'Segoe UI'">
					<source src="bilivideo.mp4" type="video/mp4">
					您的浏览器不支持视频播放
				</video>
			</div>
		</div>
		<div id="comment">
			<iframe src="//www.bilibili.com/h5/comment/sub?oid=233279383&pageType=1&root=255333250865" 
					style="width:100%; height:100%"></iframe>
		</div>
	</div>

	<script>
	// 可靠的IE检测
	function isInternetExplorer() {
		return window.navigator.userAgent.indexOf("Trident") > -1 || 
			   window.navigator.userAgent.indexOf("MSIE") > -1;
	}

	// 调整评论高度（IE专用）
	function adjustCommentHeight() {
		if (!isInternetExplorer()) return;
		
		var comment = document.getElementById('comment');
		var header = document.querySelector('h1');
		var container = document.getElementById('article-toturial');
		
		if (comment && header && container) {
			var availableHeight = container.offsetHeight - header.offsetHeight - 20;
			comment.style.height = availableHeight * 0.3 + 'px';
		}
	}

	// 初始化视频播放器
	function initVideoPlayer() {
		if (isInternetExplorer()) {
			// 显隐控制
			document.getElementById('html5-player').style.display = 'none';
			document.getElementById('ie-video-container').style.display = 'block';
			
			// 视频高度适配
			var videoPlayer = document.getElementById('ie-video-player');
			if (videoPlayer) {
				videoPlayer.style.height = document.getElementById('bili-video').offsetHeight + 'px';
			}
			
			// 初始高度调整
			adjustCommentHeight();
		}
	}

	// 窗口调整事件
	function handleResize() {
		if (isInternetExplorer()) {
			adjustCommentHeight();
			var videoPlayer = document.getElementById('ie-video-player');
			if (videoPlayer) {
				videoPlayer.style.height = document.getElementById('bili-video').offsetHeight + 'px';
			}
		}
	}

	// 初始化
	document.addEventListener('DOMContentLoaded', function() {
		initVideoPlayer();
		window.addEventListener('resize', handleResize);
	});

	// 卸载时移除监听
	window.addEventListener('beforeunload', function() {
		window.removeEventListener('resize', handleResize);
	});
	</script>
</body>
</html>